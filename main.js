!function(){"use strict";class t{constructor(t,e,s){let{name:i,link:n}=t;this._name=i,this._link=n,this._cardSelector=e,this._handleImageClick=s}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".cards__list-trash").addEventListener("click",(()=>{this._cardElement.remove()})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}_handleLikeIcon(){this._cardLikeButton.classList.toggle("cards__like-button-active")}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".cards__list-cards").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".cards__list-image"),this._cardTitle=this._cardElement.querySelector(".cards__list-title"),this._cardLikeButton=this._cardElement.querySelector(".cards__like-button"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._setEventListeners(),this._cardElement}}class e{constructor(t,e){this._formElement=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_showInputError=t=>{const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)};_hideInputError=t=>{const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.add(this._errorClass)};_checkInputValidity=t=>{t.validity.valid?this._hideInputError(t):this._showInputError(t)};_hasInvalidInput(t){let e=!1;return this._inputList.forEach((t=>{t.validity.valid||(e=!0)})),e}_toggleButtonState=()=>{this._hasInvalidInput()?this.disableButton():this._enableButton()};_enableButton=()=>{this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1};disableButton=()=>{this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0};_setEventListeners(){this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState(t)}))}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetForm(){this._formElement.reset()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}}const s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},i=(document.querySelector(".modal__close-preview-button"),document.querySelector("profile-edit-modal"),document.querySelector("#edit-profile-form"),document.querySelector("#add-card-modal"),document.querySelector("#add-card-form"),document.querySelector("#profile-edit-button")),n=(document.querySelector("#modal-close-button"),document.querySelector("#modal-add-card-close-button"),document.querySelector(".profile__add-button")),o=document.querySelector("#profile-title-input"),r=document.querySelector("#profile-description-input"),a=(document.querySelector(".cards__list"),[...document.querySelectorAll(".modal__form")]),l={},c={};class d{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(t=>{t.target.classList.contains("modal_opened")&&this.close()}))}}class u extends d{constructor(t,e){super(t),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=e,this._inputList=[...this._popupForm.querySelectorAll(".modal__input")]}_getInputValues(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._handleFormSubmit(e),this._popupForm.reset()})),super.setEventListeners()}}function m(e){return new t({name:e.name,link:e.link},"#cards-template",f).getView()}const _=new class{constructor(t,e){let{items:s,renderer:i}=t;this._items=s,this._renderer=i,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:t=>{const e=m(t);_.addItem(e)}},".cards__list");_.renderItems();const p=new u({popupSelector:"#add-card-modal"},(function(t){let{title:e,URL:s}=t;const i=m({name:e,link:s});_.addItem(i),l.addCardForm.disableButton(),p.close()}));p.setEventListeners(),n.addEventListener("click",(()=>p.open()));const h=new class{constructor(t){let{profileTitle:e,profileDescription:s}=t;this._profileTitle=document.querySelector(e),this._profileDescription=document.querySelector(s)}getUserInfo(){const t={};return t.title=this._profileTitle.textContent,t.description=this._profileDescription.textContent,t}setUserInfo(t){this._profileTitle.textContent=t.title,this._profileDescription.textContent=t.description}}({profileTitle:".profile__title",profileDescription:".profile__description"}),E=new u({popupSelector:"#profile-edit-modal"},(function(t){h.setUserInfo(t),E.close()}));function f(t,e){S.open({name:t,link:e})}E.setEventListeners();const S=new PopupWithImage({popupSelector:"#modal-image-preview"});S.setEventListeners(),a.forEach((t=>{const i=new e(s,t);i.enableValidation(),l[t.name]=i,c[t.name]=t})),i.addEventListener("click",(()=>{!function(){const t=h.getUserInfo();o.value=t.title,r.value=t.description.trim()}(),l.editCardForm.resetValidation(),E.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU02SCxFQUFXZixFQUFTSyxjQUMxQnBELEVBQWlCeUIsTUFBUXFDLEVBQVNsQixNQUNsQzNDLEVBQXVCd0IsTUFBUXFDLEVBQVNSLFlBQVlTLE1BQ3RELENBMkNFQyxHQUNBN0QsRUFBQUEsYUFBQUEsa0JBQ0FxRCxFQUFrQmhELE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcblxyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcblxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUljb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcblxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdC10cmFzaFwiKVxyXG5cclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUljb24oKSB7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZHNfX2xpa2UtYnV0dG9uLWFjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcblxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcblxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0LWNhcmRzXCIpXHJcblxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3QtaW1hZ2VcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdC10aXRsZVwiKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmNhcmRzX19saWtlLWJ1dHRvblwiXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybSkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtO1xyXG5cclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuXHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsKSA9PiB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcblxyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG5cclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWwpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuXHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcblxyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWwpID0+IHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XHJcbiAgICBsZXQgZm91bmRJbnZhbGlkID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIGZvdW5kSW52YWxpZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmb3VuZEludmFsaWQ7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfZW5hYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfTtcclxuXHJcbiAgZGlzYWJsZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG5cclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRFbCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRGb3JtKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHByZXZpZXdDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2Nsb3NlLXByZXZpZXctYnV0dG9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInByb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1mb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcblxyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNtb2RhbC1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNtb2RhbC1hZGQtY2FyZC1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcblxyXG4vL2V4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbi8vcHJvZmlsZUVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbi8vKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm1cIildO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybXMgPSB7fTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcblxyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY29uc3QgX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5cclxuICAgIF9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZSA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuXHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xyXG5cclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGluaXRpYWxDYXJkcyxcclxuICBwcm9maWxlRWRpdEZvcm0sXHJcbiAgYWRkQ2FyZEZvcm1FbGVtZW50LFxyXG4gIGNhcmRzTGlzdCxcclxuICBjb25maWcsXHJcbiAgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24sXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgcHJldmlld0Nsb3NlQnV0dG9uLFxyXG4gIGFkZE5ld0NhcmRCdG4sXHJcbiAgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24sXHJcbiAgcHJvZmlsZUVkaXRUaXRsZSxcclxuICBwcm9maWxlRWRpdERlc2NyaXB0aW9uLFxyXG4gIGZvcm1WYWxpZGF0b3JzLFxyXG4gIGZvcm1zLFxyXG4gIGZvcm1MaXN0LFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5cclxuLy9DYXJkc1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIHtcclxuICAgICAgbmFtZTogY2FyZERhdGEubmFtZSxcclxuICAgICAgbGluazogY2FyZERhdGEubGluayxcclxuICAgIH0sXHJcbiAgICBcIiNjYXJkcy10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGlja1xyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59XHJcbmNvbnN0IGNhcmRzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICBjYXJkc1NlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuY2FyZHNTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbmNvbnN0IGFkZENhcmRXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXHJcbiAgfSxcclxuICBoYW5kbGVBZGRDYXJkU3VibWl0XHJcbik7XHJcblxyXG5hZGRDYXJkV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkTmV3Q2FyZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gYWRkQ2FyZFdpdGhGb3JtLm9wZW4oKSk7XHJcblxyXG4vL3VzZXIgaW5mb1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHByb2ZpbGVUaXRsZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBwcm9maWxlRGVzY3JpcHRpb246IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gZmlsbFVzZXJEYXRhKCkge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlRWRpdFRpdGxlLnZhbHVlID0gdXNlckRhdGEudGl0bGU7XHJcbiAgcHJvZmlsZUVkaXREZXNjcmlwdGlvbi52YWx1ZSA9IHVzZXJEYXRhLmRlc2NyaXB0aW9uLnRyaW0oKTtcclxufVxyXG5cclxuY29uc3QgZWRpdE1vZGFsV2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICB7XHJcbiAgICBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICB9LFxyXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XHJcbik7XHJcblxyXG5lZGl0TW9kYWxXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhpbWFnZU5hbWUsIGltYWdlTGluaykge1xyXG4gIGltYWdlUG9wdXAub3Blbih7IG5hbWU6IGltYWdlTmFtZSwgbGluazogaW1hZ2VMaW5rIH0pO1xyXG59XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNtb2RhbC1pbWFnZS1wcmV2aWV3XCIsXHJcbn0pO1xyXG5cclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9oYW5kbGUgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCh2YWx1ZSkge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHZhbHVlKTtcclxuICBlZGl0TW9kYWxXaXRoRm9ybS5jbG9zZSgpO1xyXG59XHJcblxyXG5mb3JtTGlzdC5mb3JFYWNoKChmb3JtKSA9PiB7XHJcbiAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtKTtcclxuICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW2Zvcm0ubmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgZm9ybXNbZm9ybS5uYW1lXSA9IGZvcm07XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdCh7IHRpdGxlLCBVUkwgfSkge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKHsgbmFtZTogdGl0bGUsIGxpbms6IFVSTCB9KTtcclxuICBjYXJkc1NlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImFkZENhcmRGb3JtXCJdLmRpc2FibGVCdXR0b24oKTtcclxuICBhZGRDYXJkV2l0aEZvcm0uY2xvc2UoKTtcclxufVxyXG5cclxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmaWxsVXNlckRhdGEoKTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImVkaXRDYXJkRm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0TW9kYWxXaXRoRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG5cclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBwcm9maWxlVGl0bGUsIHByb2ZpbGVEZXNjcmlwdGlvbiB9KSB7XHJcbiAgICB0aGlzLl9wcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVUaXRsZSk7XHJcblxyXG4gICAgdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlRGVzY3JpcHRpb24pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VyQ3VycmVudEluZm8gPSB7fTtcclxuXHJcbiAgICB1c2VyQ3VycmVudEluZm8udGl0bGUgPSB0aGlzLl9wcm9maWxlVGl0bGUudGV4dENvbnRlbnQ7XHJcblxyXG4gICAgdXNlckN1cnJlbnRJbmZvLmRlc2NyaXB0aW9uID0gdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG5cclxuICAgIHJldHVybiB1c2VyQ3VycmVudEluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLnRpdGxlO1xyXG5cclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsIm5hbWUiLCJsaW5rIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZExpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VJY29uIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbW92ZSIsIl9jYXJkSW1hZ2UiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJnZXRWaWV3IiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm0iLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJmb3VuZEludmFsaWQiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXRGb3JtIiwicmVzZXQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ0biIsImFkZE5ld0NhcmRCdG4iLCJwcm9maWxlRWRpdFRpdGxlIiwicHJvZmlsZUVkaXREZXNjcmlwdGlvbiIsImZvcm1MaXN0IiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtcyIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlIiwiaW5wdXQiLCJ2YWx1ZSIsImlucHV0VmFsdWVzIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwiY2FyZHNTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImFkZENhcmRXaXRoRm9ybSIsInRpdGxlIiwiVVJMIiwibmV3Q2FyZCIsInVzZXJJbmZvIiwicHJvZmlsZVRpdGxlIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiX3Byb2ZpbGVUaXRsZSIsIl9wcm9maWxlRGVzY3JpcHRpb24iLCJnZXRVc2VySW5mbyIsInVzZXJDdXJyZW50SW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJlZGl0TW9kYWxXaXRoRm9ybSIsImltYWdlTmFtZSIsImltYWdlTGluayIsImltYWdlUG9wdXAiLCJQb3B1cFdpdGhJbWFnZSIsInZhbGlkYXRvciIsInVzZXJEYXRhIiwidHJpbSIsImZpbGxVc2VyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=